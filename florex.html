<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Florex — Оптовая продажа цветов</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --black: #121212;
            --white: #EDEDED;
            --accent-orange: #D3542C;
            --burnt-terracotta: #BD3E2D;
            --deep-coral: #F2A497;
            --dusty-olive: #4E5D59;
            --dusty-sage: #687e79;
            --light-sage: #A7B3AD;
            --light-concrete: #C5CEC9;
            --deep-slate: #3E4A49; /* Added for filter-chip */
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--white);
            color: var(--black);
            line-height: 1.6;
            min-height: 100vh;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
        }

        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 0 60px;
        }

        /* Добавил премиальные стили для header */
        header {
            background: var(--white);
            border-bottom: 1px solid var(--light-concrete);
            padding: 28px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(0,0,0,0.03);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Улучшен логотип с иконкой */
        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 28px;
            font-weight: 600;
            color: var(--black);
            text-decoration: none;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-accent {
            color: var(--accent-orange);
        }

        nav ul {
            display: flex;
            gap: 48px;
            list-style: none;
        }

        nav a {
            font-family: 'Montserrat', sans-serif;
            font-size: 15px;
            font-weight: 500;
            color: var(--black);
            text-decoration: none;
            transition: color 0.3s;
            position: relative;
        }

        nav a:hover {
            color: var(--accent-orange);
        }

        nav a::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent-orange);
            transition: width 0.3s;
        }

        nav a:hover::after {
            width: 100%;
        }

        .header-actions {
            display: flex;
            gap: 24px;
            align-items: center;
        }

        /* Заменил эмодзи на SVG иконки */
        .cart-icon {
            position: relative;
            cursor: pointer;
            width: 24px;
            height: 24px;
            transition: transform 0.3s;
        }

        .cart-icon:hover {
            transform: scale(1.1);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-orange);
            color: var(--white);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: 600;
        }

        .user-icon {
            cursor: pointer;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--dusty-sage);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
        }

        .user-icon:hover {
            background: var(--accent-orange);
            transform: scale(1.05);
        }

        /* Улучшил стили кнопок */
        .btn {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            padding: 16px 40px;
            border: none;
            cursor: pointer;
            font-size: 15px;
            transition: all 0.3s;
            border-radius: 2px;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .btn-primary {
            background: var(--accent-orange);
            color: var(--white);
            box-shadow: 0 4px 12px rgba(211, 84, 44, 0.2);
        }

        .btn-primary:hover {
            background: var(--burnt-terracotta);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(211, 84, 44, 0.3);
        }

        .btn-secondary {
            background: var(--white);
            color: var(--black);
            border: 2px solid var(--light-sage);
        }

        .btn-secondary:hover {
            background: var(--light-concrete);
            border-color: var(--dusty-sage);
        }

        .btn-outline {
            background: transparent;
            color: var(--black);
            border: 2px solid var(--black);
        }

        .btn-outline:hover {
            background: var(--black);
            color: var(--white);
        }

        /* Screens */
        .screen {
            display: none;
            min-height: calc(100vh - 100px);
        }

        .screen.active {
            display: block;
        }

        /* Новый экран регистрации вместо выбора города */
        .auth-screen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px 0;
            background: linear-gradient(135deg, var(--light-concrete) 0%, var(--white) 100%);
        }

        .auth-container {
            max-width: 520px;
            width: 100%;
            background: var(--white);
            padding: 60px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            border: 1px solid var(--light-sage);
        }

        .auth-logo {
            text-align: center;
            margin-bottom: 48px;
        }

        .auth-logo svg {
            width: 60px;
            height: 60px;
            margin-bottom: 16px;
        }

        .auth-logo h1 {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .auth-logo p {
            color: var(--dusty-olive);
            font-size: 15px;
        }

        .form-group {
            margin-bottom: 28px;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--dusty-olive);
        }

        select, input {
            width: 100%;
            padding: 16px 18px;
            border: 2px solid var(--light-sage);
            background: var(--white);
            font-family: 'Inter', sans-serif;
            font-size: 15px;
            color: var(--black);
            transition: all 0.3s;
        }

        select:focus, input:focus {
            outline: none;
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 4px rgba(211, 84, 44, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 24px 0;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            font-size: 14px;
            text-transform: none;
            letter-spacing: 0;
            font-weight: 400;
            color: var(--black);
            line-height: 1.6;
        }

        .checkbox-group a {
            color: var(--accent-orange);
            text-decoration: underline;
        }

        /* SMS подтверждение экран */
        .sms-verification {
            text-align: center;
        }

        .sms-verification h2 {
            font-size: 28px;
            margin-bottom: 16px;
        }

        .sms-verification p {
            color: var(--dusty-olive);
            margin-bottom: 40px;
            font-size: 15px;
        }

        .sms-code-inputs {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-bottom: 32px;
        }

        .sms-code-input {
            width: 70px;
            height: 70px;
            text-align: center;
            font-size: 32px;
            font-weight: 700;
            border: 2px solid var(--light-sage);
            padding: 0;
        }

        .sms-code-input:focus {
            border-color: var(--accent-orange);
        }

        .resend-code {
            color: var(--dusty-olive);
            font-size: 14px;
            margin-top: 24px;
        }

        .resend-code a {
            color: var(--accent-orange);
            text-decoration: underline;
            cursor: pointer;
        }

        /* Home Screen */
        .hero {
            padding: 100px 0 120px;
            text-align: center;
        }

        .hero h1 {
            font-size: 64px;
            font-weight: 600;
            margin-bottom: 24px;
            letter-spacing: -1px;
        }

        .hero p {
            font-size: 20px;
            color: var(--dusty-olive);
            margin-bottom: 60px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .selection-card {
            background: var(--white);
            border: 1px solid var(--light-sage);
            padding: 48px;
            max-width: 600px;
            margin: 0 auto;
        }

        .selection-card h2 {
            font-size: 24px;
            margin-bottom: 32px;
            text-align: center;
        }

        /* Улучшил карточки каталога */
        .catalog-header {
            padding: 48px 0 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--light-concrete);
        }

        .catalog-header h1 {
            font-size: 48px;
            letter-spacing: -1px;
        }

        .catalog-info {
            display: flex;
            gap: 32px;
            font-size: 14px;
            color: var(--dusty-olive);
        }

        .catalog-info span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .catalog-controls {
            padding: 32px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .filters {
            display: flex;
            gap: 16px;
        }

        .filter-btn {
            padding: 12px 24px;
            background: var(--white);
            border: 2px solid var(--light-sage);
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s;
            letter-spacing: 0.5px;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--dusty-sage);
            color: var(--white);
            border-color: var(--dusty-sage);
            transform: translateY(-1px);
        }

        .sort-select {
            width: 220px;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 40px;
            padding: 40px 0 100px;
        }

        /* Премиальные карточки товаров */
        .product-card {
            background: var(--white);
            border: 1px solid var(--light-concrete);
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--accent-orange);
            transform: scaleX(0);
            transition: transform 0.3s;
        }

        .product-card:hover {
            border-color: var(--accent-orange);
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.12);
        }

        .product-card:hover::before {
            transform: scaleX(1);
        }

        .product-image {
            width: 100%;
            height: 340px;
            background: linear-gradient(135deg, var(--light-concrete) 0%, #dae0dd 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            /* Removed font-size: 80px for emoji, now using SVG icons */
            position: relative;
            overflow: hidden; /* Added to contain the SVG icon */
        }

        /* Added styles for flower SVG icons */
        .flower-icon {
            width: 120px;
            height: 120px;
            opacity: 0.15;
            filter: blur(1px);
            color: var(--accent-orange); /* Default color for icons */
        }

        .product-status {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--white);
            padding: 8px 16px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .product-status.in-stock {
            color: var(--dusty-sage);
        }

        .product-status.pre-order {
            color: var(--accent-orange);
        }

        .product-info {
            padding: 28px;
        }

        .product-name {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 12px;
            letter-spacing: 0.3px;
        }

        .product-meta {
            display: flex;
            gap: 16px;
            margin-bottom: 20px;
            font-size: 13px;
            color: var(--dusty-olive);
        }

        .product-meta span {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .product-price {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--light-concrete);
        }

        .price {
            font-size: 26px;
            font-weight: 700;
            color: var(--black);
            letter-spacing: -0.5px;
        }

        .price-unit {
            font-size: 13px;
            color: var(--dusty-olive);
            font-weight: 400;
        }

        .add-to-cart-btn {
            padding: 10px 20px;
            background: var(--black);
            color: var(--white);
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: all 0.3s;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }

        .add-to-cart-btn:hover {
            background: var(--accent-orange);
            transform: scale(1.05);
        }

        /* Product Detail */
        .product-detail {
            padding: 60px 0 100px;
        }

        .product-detail-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 80px;
        }

        .product-detail-image {
            background: linear-gradient(135deg, var(--light-concrete) 0%, #dae0dd 100%);
            height: 600px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 140px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
        }

        .product-detail-info h1 {
            font-size: 48px;
            margin-bottom: 16px;
            letter-spacing: -1px;
        }

        .product-article {
            font-size: 14px;
            color: var(--dusty-olive);
            margin-bottom: 32px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .product-specs {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
            margin: 40px 0;
            padding: 40px;
            background: var(--light-concrete);
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.05);
        }

        .spec-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .spec-label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--dusty-olive);
            font-weight: 600;
        }

        .spec-value {
            font-size: 20px;
            font-weight: 600;
        }

        .quantity-selector {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 40px 0;
        }

        .quantity-label {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            border: 2px solid var(--light-sage);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .quantity-btn {
            width: 48px;
            height: 48px;
            border: none;
            background: var(--white);
            cursor: pointer;
            font-size: 24px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .quantity-btn:hover {
            background: var(--dusty-sage);
            color: var(--white);
        }

        .quantity-input {
            width: 100px;
            height: 48px;
            text-align: center;
            border: none;
            border-left: 2px solid var(--light-sage);
            border-right: 2px solid var(--light-sage);
            font-weight: 600;
            font-size: 18px;
        }

        .product-actions {
            display: flex;
            gap: 16px;
            margin-top: 48px;
        }

        /* Cart Screen */
        .cart-screen {
            padding: 60px 0 100px;
        }

        .cart-screen h1 {
            font-size: 48px;
            margin-bottom: 48px;
            letter-spacing: -1px;
        }

        .cart-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 48px;
        }

        .cart-items {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* Улучшил карточки корзины */
        .cart-item {
            display: grid;
            grid-template-columns: 140px 1fr auto;
            gap: 28px;
            padding: 32px;
            border: 2px solid var(--light-concrete);
            background: var(--white);
            transition: all 0.3s;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }

        .cart-item:hover {
            border-color: var(--light-sage);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .cart-item-image {
            width: 140px;
            height: 140px;
            background: linear-gradient(135deg, var(--light-concrete) 0%, #dae0dd 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
        }

        .cart-item-info h3 {
            font-size: 22px;
            margin-bottom: 10px;
        }

        .cart-item-meta {
            font-size: 14px;
            color: var(--dusty-olive);
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 20px;
        }

        .cart-item-quantity {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .cart-item-actions {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-end;
        }

        .cart-item-price {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .remove-btn {
            background: none;
            border: none;
            color: var(--dusty-olive);
            cursor: pointer;
            font-size: 13px;
            text-decoration: underline;
            transition: color 0.3s;
            font-weight: 500;
        }

        .remove-btn:hover {
            color: var(--accent-orange);
        }

        /* Улучшил сводку корзины */
        .cart-summary {
            background: var(--dusty-sage);
            color: var(--white);
            padding: 40px;
            height: fit-content;
            position: sticky;
            top: 120px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.15);
        }

        .cart-summary h2 {
            font-size: 26px;
            margin-bottom: 32px;
            letter-spacing: 0.5px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 16px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 15px;
        }

        .summary-row:last-of-type {
            border-bottom: none;
            padding-top: 28px;
            margin-top: 16px;
            border-top: 2px solid var(--white);
            font-size: 24px;
            font-weight: 700;
        }

        .promo-code {
            margin-top: 28px;
            display: flex;
            gap: 12px;
        }

        .promo-input {
            flex: 1;
            padding: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
        }

        .promo-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .promo-btn {
            padding: 14px 24px;
            background: var(--white);
            color: var(--dusty-sage);
            border: none;
            cursor: pointer;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .checkout-btn {
            width: 100%;
            margin-top: 28px;
            background: var(--accent-orange);
            padding: 18px;
        }

        .checkout-btn:hover {
            background: var(--burnt-terracotta);
        }

        /* Checkout Screen */
        .checkout-screen {
            padding: 60px 0 100px;
        }

        .checkout-screen h1 {
            font-size: 48px;
            margin-bottom: 48px;
            letter-spacing: -1px;
        }

        .checkout-grid {
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 60px;
        }

        .checkout-section {
            margin-bottom: 48px;
        }

        .checkout-section h2 {
            font-size: 26px;
            margin-bottom: 28px;
            display: flex;
            align-items: center;
            gap: 16px;
            letter-spacing: 0.3px;
        }

        .step-number {
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: var(--accent-orange);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(211, 84, 44, 0.3);
        }

        .delivery-options {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .delivery-option {
            padding: 28px;
            border: 2px solid var(--light-sage);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }

        .delivery-option:hover {
            border-color: var(--dusty-sage);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .delivery-option.selected {
            border-color: var(--accent-orange);
            background: rgba(211, 84, 44, 0.05);
            box-shadow: 0 4px 20px rgba(211, 84, 44, 0.15);
        }

        .radio {
            width: 24px;
            height: 24px;
            border: 2px solid var(--light-sage);
            border-radius: 50%;
            position: relative;
            transition: all 0.3s;
        }

        .delivery-option.selected .radio {
            border-color: var(--accent-orange);
            border-width: 3px;
        }

        .delivery-option.selected .radio::after {
            content: '';
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--accent-orange);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .delivery-info {
            flex: 1;
        }

        .delivery-info h3 {
            font-size: 18px;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .delivery-info p {
            font-size: 14px;
            color: var(--dusty-olive);
            line-height: 1.6;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
        }

        .payment-method {
            padding: 32px;
            border: 2px solid var(--light-sage);
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }

        .payment-method:hover {
            border-color: var(--dusty-sage);
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .payment-method.selected {
            border-color: var(--accent-orange);
            background: rgba(211, 84, 44, 0.05);
            box-shadow: 0 4px 20px rgba(211, 84, 44, 0.15);
        }

        .payment-icon {
            font-size: 40px;
            margin-bottom: 16px;
        }

        .payment-method h3 {
            font-size: 16px;
            font-weight: 600;
        }

        /* Улучшил сводку заказа */
        .order-summary {
            background: var(--light-concrete);
            padding: 40px;
            height: fit-content;
            position: sticky;
            top: 120px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
        }

        .order-summary h2 {
            font-size: 26px;
            margin-bottom: 32px;
            letter-spacing: 0.5px;
        }

        .order-items {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 32px;
            max-height: 320px;
            overflow-y: auto;
        }

        .order-item {
            display: flex;
            gap: 16px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--light-sage);
        }

        .order-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .order-item-image {
            width: 70px;
            height: 70px;
            background: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .order-item-info {
            flex: 1;
        }

        .order-item-info h4 {
            font-size: 15px;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .order-item-info p {
            font-size: 13px;
            color: var(--dusty-olive);
        }

        .order-item-price {
            font-weight: 700;
            font-size: 17px;
        }

        .place-order-btn {
            width: 100%;
            padding: 20px;
            background: var(--accent-orange);
            color: var(--white);
            border: none;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 4px 16px rgba(211, 84, 44, 0.3);
        }

        .place-order-btn:hover {
            background: var(--burnt-terracotta);
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(211, 84, 44, 0.4);
        }

        /* Payment Screen */
        .payment-screen {
            padding: 60px 0 100px;
        }

        .payment-container {
            max-width: 640px;
            margin: 0 auto;
        }

        .payment-container h1 {
            font-size: 48px;
            margin-bottom: 16px;
            text-align: center;
            letter-spacing: -1px;
        }

        .order-number {
            text-align: center;
            font-size: 16px;
            color: var(--dusty-olive);
            margin-bottom: 48px;
        }

        .payment-card {
            background: var(--white);
            border: 2px solid var(--light-sage);
            padding: 48px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.08);
        }

        .payment-amount {
            text-align: center;
            margin-bottom: 40px;
        }

        .payment-amount-label {
            font-size: 14px;
            color: var(--dusty-olive);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .payment-amount-value {
            font-size: 56px;
            font-weight: 700;
            color: var(--accent-orange);
            letter-spacing: -2px;
        }

        .payment-method-selected {
            background: var(--dusty-sage);
            color: var(--white);
            padding: 20px 28px;
            text-align: center;
            margin-bottom: 40px;
            font-weight: 600;
            letter-spacing: 0.5px;
            font-size: 15px;
        }

        .card-input-group {
            margin-bottom: 24px;
        }

        .card-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }

        .payment-actions {
            display: flex;
            gap: 20px;
            margin-top: 40px;
        }

        .payment-actions .btn {
            flex: 1;
        }

        /* Success Screen */
        .success-screen {
            padding: 120px 0;
            text-align: center;
        }

        .success-icon {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--dusty-sage) 0%, var(--dusty-olive) 100%);
            color: var(--white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 70px;
            margin: 0 auto 40px;
            box-shadow: 0 12px 40px rgba(104, 126, 121, 0.3);
        }

        .success-screen h1 {
            font-size: 52px;
            margin-bottom: 20px;
            letter-spacing: -1px;
        }

        .success-screen p {
            font-size: 18px;
            color: var(--dusty-olive);
            margin-bottom: 56px;
            line-height: 1.8;
        }

        .success-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        /* Account Screen */
        .account-screen {
            padding: 60px 0 100px;
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 56px;
            padding-bottom: 28px;
            border-bottom: 2px solid var(--light-concrete);
        }

        .account-header h1 {
            font-size: 52px;
            letter-spacing: -1px;
        }

        .account-grid {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 60px;
        }

        .account-menu {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .account-menu-item {
            padding: 18px 24px;
            border: 2px solid var(--light-concrete);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            background: var(--white);
            font-size: 15px;
            letter-spacing: 0.3px;
        }

        .account-menu-item:hover {
            background: var(--light-concrete);
            border-color: var(--dusty-sage);
            transform: translateX(4px);
        }

        .account-menu-item.active {
            background: var(--dusty-sage);
            color: var(--white);
            border-color: var(--dusty-sage);
            transform: translateX(8px);
            box-shadow: 0 4px 16px rgba(104, 126, 121, 0.3);
        }

        .account-content-section {
            display: none;
        }

        .account-content-section.active {
            display: block;
        }

        .account-info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 28px;
        }

        .info-card {
            padding: 28px;
            background: var(--white);
            border: 2px solid var(--light-sage);
            transition: all 0.3s;
            box-shadow: 0 2px 12px rgba(0,0,0,0.04);
        }

        .info-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 24px rgba(0,0,0,0.08);
        }

        .info-card h3 {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--dusty-olive);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .info-card p {
            font-size: 19px;
            font-weight: 600;
        }

        .orders-list {
            display: flex;
            flex-direction: column;
            gap: 28px;
        }

        .order-card {
            background: var(--white);
            border: 2px solid var(--light-sage);
            padding: 36px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            transition: all 0.3s;
        }

        .order-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 28px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--light-concrete);
        }

        .order-number-display {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: 0.3px;
        }

        .order-status {
            padding: 10px 20px;
            background: var(--dusty-sage);
            color: var(--white);
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Order status classes were updated in the <updates> section, using those */
        .order-status.awaiting { /* New: Ожидает оплаты */
            background: var(--accent-orange);
        }

        .order-status.paid { /* Existing */
            background: var(--dusty-sage);
        }
        
        .order-status.ready { /* New */
            background: var(--dusty-olive);
        }

        .order-status.completed { /* New */
            background: #4a7c59; /* Dark green for completed */
        }
        
        .order-status.new { /* New */
            background: var(--light-sage);
        }

        .order-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 28px;
            margin-bottom: 28px;
        }

        .order-detail-item h4 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--dusty-olive);
            margin-bottom: 6px;
            font-weight: 700;
        }

        .order-detail-item p {
            font-size: 17px;
            font-weight: 600;
        }

        /* Footer */
        footer {
            background: var(--dusty-sage);
            color: var(--white);
            padding: 80px 0 40px;
            margin-top: 120px;
        }

        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 80px;
            margin-bottom: 60px;
        }

        .footer-section h3 {
            font-size: 19px;
            margin-bottom: 24px;
            letter-spacing: 0.5px;
        }

        .footer-section p {
            font-size: 14px;
            line-height: 1.9;
            opacity: 0.9;
        }

        .footer-links {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .footer-links a {
            color: var(--white);
            text-decoration: none;
            font-size: 14px;
            opacity: 0.9;
            transition: opacity 0.3s;
        }

        .footer-links a:hover {
            opacity: 1;
            transform: translateX(4px);
        }

        .footer-bottom {
            padding-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            font-size: 13px;
            opacity: 0.7;
        }

        /* Utilities */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            color: var(--dusty-olive);
            text-decoration: none;
            font-weight: 600;
            margin-bottom: 40px;
            transition: all 0.3s;
            font-size: 15px;
        }

        .back-link:hover {
            color: var(--accent-orange);
            transform: translateX(-4px);
        }

        /* Добавлены улучшенные фильтры */
        .filters-container {
            background: linear-gradient(135deg, #f8f9f9 0%, #e8eceb 100%);
            border-radius: 16px;
            padding: 0;
            margin-bottom: 48px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .filters-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px 32px;
            background: var(--white);
            border-bottom: 2px solid var(--light-concrete);
        }

        .filters-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--dusty-olive);
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 0;
        }

        .filters-title svg {
            width: 20px;
            height: 20px;
            stroke: var(--accent-orange);
        }

        .filters-reset {
            padding: 10px 20px;
            background: transparent;
            border: 2px solid var(--light-sage);
            color: var(--dusty-sage);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filters-reset:hover {
            background: var(--accent-orange);
            color: var(--white);
            border-color: var(--accent-orange);
        }

        .filters-advanced {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            padding: 32px;
            background: var(--white);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .filter-group label {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--dusty-sage);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-group label svg {
            width: 16px;
            height: 16px;
            stroke: var(--accent-orange);
        }

        .filter-group select {
            padding: 14px 18px;
            border: 2px solid #e0e5e3;
            background: var(--white);
            font-size: 14px;
            font-weight: 500;
            font-family: 'Inter', sans-serif;
            color: var(--dusty-olive);
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 8px;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L6 6L11 1' stroke='%23687e79' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            padding-right: 44px;
        }

        .filter-group select:hover {
            border-color: var(--dusty-sage);
            box-shadow: 0 2px 8px rgba(104, 126, 121, 0.1);
        }

        .filter-group select:focus {
            outline: none;
            border-color: var(--accent-orange);
            box-shadow: 0 0 0 4px rgba(211, 84, 44, 0.1);
        }

        .sort-section {
            padding: 24px 32px;
            background: linear-gradient(135deg, #fafbfb 0%, #f4f6f5 100%);
            border-top: 2px solid var(--light-concrete);
        }

        .sort-section label {
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--dusty-sage);
            display: block;
            margin-bottom: 16px;
        }

        .sort-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .sort-btn {
            padding: 12px 20px;
            background: var(--white);
            border: 2px solid #e0e5e3;
            color: var(--dusty-olive);
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Montserrat', sans-serif;
        }

        .sort-btn svg {
            width: 16px;
            height: 16px;
            stroke: currentColor;
        }

        .sort-btn:hover {
            background: var(--light-concrete);
            border-color: var(--dusty-sage);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(104, 126, 121, 0.15);
        }

        .sort-btn.active {
            background: var(--accent-orange);
            color: var(--white);
            border-color: var(--accent-orange);
            box-shadow: 0 4px 16px rgba(211, 84, 44, 0.3);
        }

        .active-filters {
            padding: 0 32px 24px 32px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            background: var(--white);
            /* добавляем выравнивание элементов */
            align-items: center;
        }

        /* добавляем стили для лейбла "Активные фильтры:" */
        .active-filters-label {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--dusty-olive);
            letter-spacing: 0.3px;
        }

        .filter-chip {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, var(--dusty-sage) 0%, var(--deep-slate) 100%);
            color: var(--white);
            border-radius: 20px;
            /* используем правильный шрифт Montserrat */
            font-family: 'Montserrat', sans-serif;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            letter-spacing: 0.2px;
        }

        .filter-chip:hover {
            background: linear-gradient(135deg, var(--deep-slate) 0%, var(--dusty-olive) 100%);
            transform: scale(1.05);
        }

        .filter-chip svg {
            width: 14px;
            height: 14px;
            stroke: currentColor;
        }

        /* Улучшенные карточки товаров с ценой за коробку и упаковку */
        .product-pricing {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .price-per-box {
            font-size: 26px;
            font-weight: 700;
            color: var(--black);
        }

        .price-per-unit {
            font-size: 14px;
            color: var(--dusty-olive);
        }

        /* Калькулятор коробок в корзине */
        .cart-calculator {
            background: var(--light-concrete);
            padding: 28px;
            margin-top: 24px;
            border-left: 4px solid var(--accent-orange);
        }

        .calc-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 15px;
        }

        .calc-row strong {
            font-weight: 700;
            color: var(--black);
        }

        /* Доверенные получатели */
        .trusted-recipients {
            margin-top: 28px;
            padding-top: 28px;
            border-top: 2px solid var(--light-concrete);
        }

        .recipient-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 16px;
        }

        .recipient-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: var(--white);
            border: 2px solid var(--light-sage);
        }

        .recipient-item:hover {
            border-color: var(--dusty-sage);
        }

        /* Чат-бот */
        .chatbot-trigger {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-orange) 0%, var(--burnt-terracotta) 100%);
            color: var(--white);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 8px 24px rgba(211, 84, 44, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .chatbot-trigger:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(211, 84, 44, 0.5);
        }

        .chatbot-window {
            position: fixed;
            bottom: 130px;
            right: 40px;
            width: 400px;
            height: 600px;
            background: var(--white);
            border: 2px solid var(--light-sage);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            flex-direction: column;
            border-radius: 4px;
            overflow: hidden;
        }

        .chatbot-window.active {
            display: flex;
        }

        .chatbot-header {
            background: var(--dusty-sage);
            color: var(--white);
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-header h3 {
            font-size: 18px;
            font-weight: 600;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: var(--white);
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chatbot-close:hover {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
        }

        .chatbot-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-message {
            margin-bottom: 16px;
            display: flex;
            flex-direction: column;
        }

        .chat-message.bot {
            align-items: flex-start;
        }

        .chat-message.user {
            align-items: flex-end;
        }

        .message-bubble {
            max-width: 80%;
            padding: 14px 18px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.6;
        }

        .chat-message.bot .message-bubble {
            background: var(--white);
            border: 2px solid var(--light-sage);
        }

        .chat-message.user .message-bubble {
            background: var(--dusty-sage);
            color: var(--white);
        }

        .chatbot-input-area {
            padding: 20px;
            background: var(--white);
            border-top: 2px solid var(--light-concrete);
            display: flex;
            gap: 12px;
        }

        .chatbot-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--light-sage);
            font-family: 'Inter', sans-serif;
            font-size: 14px;
        }

        .chatbot-send {
            padding: 12px 24px;
            background: var(--accent-orange);
            color: var(--white);
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .chatbot-send:hover {
            background: var(--burnt-terracotta);
        }

        /* Премиальные акценты */
        .premium-badge {
            display: inline-block;
            padding: 6px 14px;
            background: linear-gradient(135deg, var(--accent-orange) 0%, var(--burnt-terracotta) 100%);
            color: var(--white);
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 2px 8px rgba(211, 84, 44, 0.3);
        }

        .section-title {
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--dusty-olive);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--accent-orange);
            display: inline-block;
        }

        @media (max-width: 1024px) {
            .container {
                padding: 0 32px;
            }

            .products-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .checkout-grid {
                grid-template-columns: 1fr;
            }

            .cart-grid {
                grid-template-columns: 1fr;
            }
            
            .cart-summary {
                position: static;
                margin-top: 48px;
            }
            
            .order-summary {
                position: static;
                margin-top: 48px;
            }
            
            .account-grid {
                grid-template-columns: 1fr;
            }
            
            .account-menu-item.active {
                transform: translateX(0);
            }

            .chatbot-window {
                right: 16px;
                bottom: 110px;
            }

            .chatbot-trigger {
                right: 16px;
                bottom: 40px;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
            }

            nav ul {
                display: none; /* Hide nav on smaller screens, implement mobile menu later */
            }

            .hero h1 {
                font-size: 48px;
            }

            .hero p {
                font-size: 18px;
            }
            
            .catalog-header {
                flex-wrap: wrap;
                text-align: center;
                justify-content: center;
            }
            
            .catalog-info {
                flex-wrap: wrap;
                justify-content: center;
                gap: 20px;
                margin-top: 20px;
            }

            .products-grid {
                grid-template-columns: 1fr;
            }

            .product-detail-grid {
                grid-template-columns: 1fr;
                gap: 40px;
            }

            .product-detail-image {
                height: 400px;
            }

            .cart-item {
                grid-template-columns: 100px 1fr auto;
                gap: 16px;
            }
            
            .cart-item-image {
                width: 100px;
                height: 100px;
                font-size: 40px;
            }

            .cart-item-info h3 {
                font-size: 18px;
            }
            
            .cart-item-price {
                font-size: 24px;
            }

            .checkout-grid {
                gap: 32px;
            }

            .payment-methods {
                grid-template-columns: 1fr;
            }

            .payment-method {
                margin-bottom: 10px;
            }

            .success-screen h1 {
                font-size: 44px;
            }

            .success-screen p {
                font-size: 16px;
            }

            .footer-grid {
                grid-template-columns: 1fr;
                gap: 40px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#" class="logo" onclick="showScreen('home')">
                    <!-- Добавил SVG логотип вместо текста -->
                    <div class="logo-icon">
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none">
                            <circle cx="18" cy="18" r="16" stroke="#D3542C" stroke-width="2.5"/>
                            <circle cx="18" cy="18" r="6" fill="#D3542C"/>
                        </svg>
                    </div>
                    FL<span class="logo-accent">Ø</span>REX
                </a>
                <nav>
                    <ul>
                        <li><a href="#" onclick="showScreen('catalog')">Каталог</a></li>
                        <li><a href="#">О компании</a></li>
                        <li><a href="#">Контакты</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <div class="cart-icon" onclick="showScreen('cart')">
                        <!-- SVG иконка корзины -->
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                            <line x1="3" y1="6" x2="21" y2="6"/>
                            <path d="M16 10a4 4 0 0 1-8 0"/>
                        </svg>
                        <span class="cart-count" id="cartCount">0</span>
                    </div>
                    <div class="user-icon" onclick="showScreen('account')">ГА</div>
                </div>
            </div>
        </div>
    </header>

    <!-- Новый экран регистрации вместо выбора города -->
    <div id="homeScreen" class="screen active">
        <div class="auth-screen">
            <div class="auth-container">
                <div class="auth-logo">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none">
                        <circle cx="30" cy="30" r="28" stroke="#D3542C" stroke-width="3"/>
                        <circle cx="30" cy="30" r="10" fill="#D3542C"/>
                    </svg>
                    <h1>Регистрация</h1>
                    <p>Заполните данные для входа в систему</p>
                </div>
                <form onsubmit="startRegistration(event)">
                    <div class="form-group">
                        <label>Название компании</label>
                        <input type="text" id="companyName" placeholder="ТОО «Bloom Atelier Almaty»" required>
                    </div>
                    <div class="form-group">
                        <label>БИН/ИИН</label>
                        <input type="text" id="binIin" placeholder="123456789012" maxlength="12" required>
                    </div>
                    <div class="form-group">
                        <label>Мобильный телефон</label>
                        <input type="tel" id="phoneNumber" placeholder="+7 (___) ___-__-__" required>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="agreeTerms" required>
                        <label for="agreeTerms">Согласен с условиями <a href="#" target="_blank">Публичной оферты</a></label>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 16px;">Подтвердить через SMS</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Новый экран SMS подтверждения -->
    <div id="smsScreen" class="screen">
        <div class="auth-screen">
            <div class="auth-container">
                <div class="sms-verification">
                    <h2>Введите код подтверждения</h2>
                    <p>Код отправлен на номер <strong id="displayPhone">+7 (700) 123-45-67</strong></p>
                    <form onsubmit="verifySMS(event)">
                        <div class="sms-code-inputs">
                            <input type="text" class="sms-code-input" maxlength="1" id="code1" required>
                            <input type="text" class="sms-code-input" maxlength="1" id="code2" required>
                            <input type="text" class="sms-code-input" maxlength="1" id="code3" required>
                            <input type="text" class="sms-code-input" maxlength="1" id="code4" required>
                        </div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">Войти в систему</button>
                        <div class="resend-code">
                            Не пришел код? <a onclick="resendCode()">Отправить повторно</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Catalog Screen -->
    <div id="catalogScreen" class="screen">
        <div class="container">
            <div class="catalog-header">
                <h1>Каталог</h1>
                <div class="catalog-info">
                    <span>
                        <!-- SVG иконка вместо эмодзи -->
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                            <circle cx="12" cy="10" r="3"/>
                        </svg>
                        <span id="selectedCity">Алматы</span>
                    </span>
                    <span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                            <line x1="16" y1="2" x2="16" y2="6"/>
                            <line x1="8" y1="2" x2="8" y2="6"/>
                            <line x1="3" y1="10" x2="21" y2="10"/>
                        </svg>
                        <span id="selectedDate">Сегодня</span>
                    </span>
                </div>
            </div>
            
            <!-- Переделанный премиальный блок фильтров -->
            <div class="filters-container">
                <div class="filters-header">
                    <h2 class="filters-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
                        </svg>
                        Фильтры
                    </h2>
                    <button class="filters-reset" onclick="resetFilters()">
                        Сбросить все
                    </button>
                </div>

                <div class="filters-advanced">
                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2z"/>
                                <path d="M12 6v6l4 2"/>
                            </svg>
                            Вид цветка
                        </label>
                        <select id="filterType" onchange="applyFilters()">
                            <option value="">Все виды</option>
                            <option value="roses">Розы</option>
                            <option value="tulips">Тюльпаны</option>
                            <option value="chrysanthemums">Хризантемы</option>
                            <option value="eustoma">Эустома</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="2" y1="12" x2="22" y2="12"/>
                                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                            </svg>
                            Страна поставщик
                        </label>
                        <select id="filterCountry" onchange="applyFilters()">
                            <option value="">Все страны</option>
                            <option value="NL">Нидерланды</option>
                            <option value="EC">Эквадор</option>
                            <option value="KE">Кения</option>
                            <option value="CO">Колумбия</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <polyline points="9 11 12 14 22 4"/>
                            </svg>
                            Наличие
                        </label>
                        <select id="filterAvailability" onchange="applyFilters()">
                            <option value="">Все товары</option>
                            <option value="stock">В наличии</option>
                            <option value="preorder">В пути</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                            </svg>
                            Цвет
                        </label>
                        <select id="filterColor" onchange="applyFilters()">
                            <option value="">Все цвета</option>
                            <option value="Красный">Красный</option>
                            <option value="Белый">Белый</option>
                            <option value="Розовый">Розовый</option>
                            <option value="Персиковый">Персиковый</option>
                            <option value="Зеленый">Зеленый</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="2" x2="12" y2="22"/>
                                <polyline points="5 9 12 2 19 9"/>
                            </svg>
                            Рост
                        </label>
                        <select id="filterHeight" onchange="applyFilters()">
                            <option value="">Любой рост</option>
                            <option value="38">38 см</option>
                            <option value="55">55 см</option>
                            <option value="60">60 см</option>
                            <option value="70">70 см</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                <line x1="16" y1="2" x2="16" y2="6"/>
                                <line x1="8" y1="2" x2="8" y2="6"/>
                                <line x1="3" y1="10" x2="21" y2="10"/>
                            </svg>
                            Дни на складе
                        </label>
                        <select id="filterDays" onchange="applyFilters()">
                            <option value="">Любой срок</option>
                            <option value="1">Сегодня</option>
                            <option value="3">До 3 дней</option>
                            <option value="5">До 5 дней</option>
                            <option value="7">До недели</option>
                        </select>
                    </div>
                </div>

                <div class="sort-section">
                    <label>Сортировка:</label>
                    <div class="sort-buttons">
                        <button class="sort-btn active" onclick="setSorting('popular', this)" data-sort-key="popular">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/>
                                <polyline points="17 6 23 6 23 12"/>
                            </svg>
                            Популярные
                        </button>
                        <button class="sort-btn" onclick="setSorting('price-asc', this)" data-sort-key="price-asc">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="19" x2="12" y2="5"/>
                                <polyline points="5 12 12 5 19 12"/>
                            </svg>
                            Цена ↑
                        </button>
                        <button class="sort-btn" onclick="setSorting('price-desc', this)" data-sort-key="price-desc">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <polyline points="19 12 12 19 5 12"/>
                            </svg>
                            Цена ↓
                        </button>
                        <button class="sort-btn" onclick="setSorting('name', this)" data-sort-key="name">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="4" y1="9" x2="20" y2="9"/>
                                <line x1="4" y1="15" x2="20" y2="15"/>
                                <line x1="10" y1="3" x2="8" y2="21"/>
                                <line x1="16" y1="3" x2="14" y2="21"/>
                            </svg>
                            А-Я
                        </button>
                        <button class="sort-btn" onclick="setSorting('stock', this)" data-sort-key="stock">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                <polyline points="9 11 12 14 22 4"/>
                            </svg>
                            В наличии
                        </button>
                    </div>
                </div>

                <div class="active-filters" id="activeFilters"></div>
            </div>

            <div class="products-grid" id="productsGrid">
                <!-- Products will be generated by JS -->
            </div>
        </div>
    </div>

    <!-- Product Detail Screen -->
    <div id="productScreen" class="screen">
        <div class="container">
            <a href="#" class="back-link" onclick="showScreen('catalog')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"/>
                    <polyline points="12 19 5 12 12 5"/>
                </svg>
                Назад к каталогу
            </a>
            <div class="product-detail">
                <div class="product-detail-grid">
                    <div class="product-detail-image" id="productDetailImage">🌹</div>
                    <div class="product-detail-info">
                        <h1 id="productDetailName">Роза Red Naomi</h1>
                        <p class="product-article" id="productDetailArticle">Артикул: RN50-2024-NL</p>
                        <div class="product-specs">
                            <div class="spec-item">
                                <span class="spec-label">Цвет</span>
                                <span class="spec-value" id="productDetailColor">Красный</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Рост</span>
                                <span class="spec-value" id="productDetailHeight">60 см</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">Страна</span>
                                <span class="spec-value" id="productDetailCountry">Нидерланды</span>
                            </div>
                            <div class="spec-item">
                                <span class="spec-label">В упаковке</span>
                                <span class="spec-value" id="productDetailBox">50 шт</span>
                            </div>
                        </div>
                        <div class="quantity-selector">
                            <span class="quantity-label">Количество упаковок:</span>
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="changeQuantity(-1)">−</button>
                                <input type="number" class="quantity-input" id="productQuantity" value="1" min="1">
                                <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
                            </div>
                        </div>
                        <div class="price" style="font-size: 40px; margin: 32px 0;">
                            <span id="productDetailPrice">128 000</span> ₸ <span class="price-unit">/ упаковка</span>
                        </div>
                        <div class="product-actions">
                            <button class="btn btn-primary" style="flex: 2;" onclick="addToCartFromDetail()">Добавить в корзину</button>
                            <button class="btn btn-outline" onclick="showScreen('catalog')">Продолжить покупки</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Screen -->
    <div id="cartScreen" class="screen">
        <div class="container">
            <a href="#" class="back-link" onclick="showScreen('catalog')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"/>
                    <polyline points="12 19 5 12 12 5"/>
                </svg>
                Продолжить покупки
            </a>
            <div class="cart-screen">
                <h1>Корзина</h1>
                <div class="cart-grid">
                    <div class="cart-items" id="cartItems">
                        <!-- Cart items will be generated by JS -->
                    </div>
                    <div class="cart-summary">
                        <h2>Итого</h2>
                        
                        <!-- Добавлен калькулятор коробок -->
                        <div class="cart-calculator">
                            <div class="section-title">Расчет</div>
                            <div class="calc-row">
                                <span>Всего упаковок:</span>
                                <strong id="totalPackages">0</strong>
                            </div>
                            <div class="calc-row">
                                <span>Всего коробок:</span>
                                <strong id="totalBoxes">0</strong>
                            </div>
                            <div class="calc-row">
                                <span>Всего стеблей:</span>
                                <strong id="totalStems">0</strong>
                            </div>
                        </div>

                        <div class="summary-row">
                            <span>Товары (<span id="summaryItemCount">0</span>)</span>
                            <span id="summarySubtotal">0 ₸</span>
                        </div>
                        <div class="summary-row">
                            <span>Скидка</span>
                            <span id="summaryDiscount">0 ₸</span>
                        </div>
                        <div class="summary-row">
                            <span>Всего</span>
                            <span id="summaryTotal">0 ₸</span>
                        </div>
                        <div class="promo-code">
                            <input type="text" class="promo-input" id="promoInput" placeholder="Промокод">
                            <button class="promo-btn" onclick="applyPromo()">OK</button>
                        </div>
                        <button class="btn checkout-btn" onclick="showScreen('checkout')">Оформить заказ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Checkout Screen -->
    <div id="checkoutScreen" class="screen">
        <div class="container">
            <a href="#" class="back-link" onclick="showScreen('cart')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="19" y1="12" x2="5" y2="12"/>
                    <polyline points="12 19 5 12 12 5"/>
                </svg>
                Вернуться в корзину
            </a>
            <div class="checkout-screen">
                <h1>Оформление заказа</h1>
                <div class="checkout-grid">
                    <div>
                        <div class="checkout-section">
                            <h2><span class="step-number">1</span> Способ получения</h2>
                            <div class="delivery-options">
                                <div class="delivery-option selected" onclick="selectDelivery(this)">
                                    <div class="radio"></div>
                                    <div class="delivery-info">
                                        <h3>Самовывоз</h3>
                                        <p>Алматы, Проспект Суюнбая, 37 • Пн–Пт: 08:00–19:00</p>
                                    </div>
                                    <strong>Бесплатно</strong>
                                </div>
                                <div class="delivery-option" onclick="selectDelivery(this)">
                                    <div class="radio"></div>
                                    <div class="delivery-info">
                                        <h3>Доставка курьером</h3>
                                        <p>В пределах города • Доставка в день заказа</p>
                                    </div>
                                    <strong>5 000 ₸</strong>
                                </div>
                            </div>
                        </div>
                        <div class="checkout-section">
                            <h2><span class="step-number">2</span> Способ оплаты</h2>
                            <div class="payment-methods">
                                <div class="payment-method selected" onclick="selectPayment(this, 'card')">
                                    <div class="payment-icon">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
                                            <line x1="1" y1="10" x2="23" y2="10"/>
                                        </svg>
                                    </div>
                                    <h3>Картой</h3>
                                </div>
                                <div class="payment-method" onclick="selectPayment(this, 'kaspi')">
                                    <div class="payment-icon">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10"/>
                                            <path d="M8 12h8"/>
                                            <path d="M12 8v8"/>
                                        </svg>
                                    </div>
                                    <h3>Kaspi Pay</h3>
                                </div>
                                <div class="payment-method" onclick="selectPayment(this, 'balance')">
                                    <div class="payment-icon">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                                        </svg>
                                    </div>
                                    <h3>Баланс</h3>
                                </div>
                                <!-- Добавлен новый способ оплаты - выставить счет -->
                                <div class="payment-method" onclick="selectPayment(this, 'invoice')">
                                    <div class="payment-icon">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                            <polyline points="14 2 14 8 20 8"/>
                                            <line x1="16" y1="13" x2="8" y2="13"/>
                                            <line x1="16" y1="17" x2="8" y2="17"/>
                                            <polyline points="10 9 9 9 8 9"/>
                                        </svg>
                                    </div>
                                    <h3>Выставить счет</h3>
                                    <p style="font-size: 11px; color: var(--dusty-olive); margin-top: 8px;">Для юр. лиц</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="order-summary">
                        <h2>Ваш заказ</h2>
                        <div class="order-items" id="checkoutItems">
                            <!-- Will be filled by JS -->
                        </div>
                        <div class="summary-row">
                            <span>Товары</span>
                            <span id="checkoutSubtotal">0 ₸</span>
                        </div>
                        <div class="summary-row">
                            <span>Доставка</span>
                            <span id="checkoutDelivery">0 ₸</span>
                        </div>
                        <div class="summary-row">
                            <span>Всего</span>
                            <span id="checkoutTotal">0 ₸</span>
                        </div>
                        <button class="place-order-btn" onclick="proceedToPayment()">Перейти к оплате</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Screen -->
    <div id="paymentScreen" class="screen">
        <div class="container">
            <div class="payment-screen">
                <div class="payment-container">
                    <h1>Оплата заказа</h1>
                    <p class="order-number">Заказ № <span id="paymentOrderNumber">123456789</span></p>
                    <div class="payment-card">
                        <div class="payment-amount">
                            <div class="payment-amount-label">К оплате</div>
                            <div class="payment-amount-value" id="paymentAmount">128 000 ₸</div>
                        </div>
                        <div class="payment-method-selected" id="selectedPaymentMethod">Оплата банковской картой</div>
                        <div id="cardPaymentForm">
                            <div class="card-input-group">
                                <label>Номер карты</label>
                                <input type="text" placeholder="0000 0000 0000 0000" maxlength="19">
                            </div>
                            <div class="card-row">
                                <div class="card-input-group">
                                    <label>Срок действия</label>
                                    <input type="text" placeholder="ММ/ГГ" maxlength="5">
                                </div>
                                <div class="card-input-group">
                                    <label>CVV</label>
                                    <input type="text" placeholder="000" maxlength="3">
                                </div>
                            </div>
                        </div>
                        <div class="payment-actions">
                            <button class="btn btn-secondary" onclick="showScreen('checkout')">Назад</button>
                            <button class="btn btn-primary" onclick="completePayment()">Оплатить</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Screen -->
    <div id="successScreen" class="screen">
        <div class="container">
            <div class="success-screen">
                <div class="success-icon">✓</div>
                <h1>Платеж принят!</h1>
                <p>Ваш заказ № <strong id="successOrderNumber">123456789</strong> успешно оформлен<br>Мы отправили подтверждение на вашу почту</p>
                <div class="success-actions">
                    <button class="btn btn-primary" onclick="showScreen('account')">Перейти в личный кабинет</button>
                    <button class="btn btn-outline" onclick="showScreen('catalog')">Продолжить покупки</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Screen -->
    <div id="accountScreen" class="screen">
        <div class="container">
            <div class="account-screen">
                <div class="account-header">
                    <h1>Личный кабинет</h1>
                    <button class="btn btn-secondary">Выход</button>
                </div>
                <div class="account-grid">
                    <div class="account-menu">
                        <div class="account-menu-item active" onclick="showAccountSection('profile')">Личные данные</div>
                        <div class="account-menu-item" onclick="showAccountSection('orders')">Мои заказы</div>
                        <div class="account-menu-item" onclick="showAccountSection('balance')">Мой баланс</div>
                        <div class="account-menu-item" onclick="showAccountSection('recipients')">Доверенные лица</div>
                    </div>
                    <div>
                        <!-- Profile Section -->
                        <div class="account-content-section active" id="profileSection">
                            <h2 style="font-size: 36px; margin-bottom: 40px;">Личные данные</h2>
                            <div class="section-title">Реквизиты компании</div>
                            <div class="account-info-grid">
                                <div class="info-card">
                                    <h3>Название компании</h3>
                                    <p>Bloom Atelier Almaty</p>
                                </div>
                                <div class="info-card">
                                    <h3>БИН/ИИН</h3>
                                    <p>123456789012</p>
                                </div>
                                <div class="info-card">
                                    <h3>Контактное лицо</h3>
                                    <p>Гульжан Абдуллаева</p>
                                </div>
                                <div class="info-card">
                                    <h3>Телефон</h3>
                                    <p>+7 (700) 123-45-67</p>
                                </div>
                                <div class="info-card">
                                    <h3>Email</h3>
                                    <p>info@bloomatelier.kz</p>
                                </div>
                                <div class="info-card">
                                    <h3>Адрес</h3>
                                    <p>Алматы, ул. Кабанбай батыра, 10</p>
                                </div>
                            </div>
                            
                            <!-- Добавлена секция с личной скидкой -->
                            <div class="section-title" style="margin-top: 48px;">Бонусы и скидки</div>
                            <div class="info-card" style="padding: 32px;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <h3 style="font-size: 16px; margin-bottom: 8px;">Ваша личная скидка</h3>
                                        <p style="font-size: 32px; font-weight: 700; color: var(--accent-orange);">15%</p>
                                    </div>
                                    <div class="premium-badge">VIP Клиент</div>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" style="margin-top: 40px;">Редактировать данные</button>
                        </div>

                        <!-- Улучшенный раздел заказов со статусами -->
                        <div class="account-content-section" id="ordersSection">
                            <h2 style="font-size: 36px; margin-bottom: 40px;">Мои заказы</h2>
                            <div class="orders-list">
                                <div class="order-card">
                                    <div class="order-header">
                                        <span class="order-number-display">Заказ № 123456789</span>
                                        <span class="order-status awaiting">Ожидает оплаты</span>
                                    </div>
                                    <div class="order-details">
                                        <div class="order-detail-item">
                                            <h4>Дата заказа</h4>
                                            <p>16 ноября 2025</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Оригинальная цена</h4>
                                            <p style="text-decoration: line-through; color: var(--dusty-olive);">280 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Итоговая цена</h4>
                                            <p style="color: var(--accent-orange); font-weight: 700;">256 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Всего коробок</h4>
                                            <p>6 коробок (300 шт)</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Получение</h4>
                                            <p>Самовывоз • 18 ноября</p>
                                        </div>
                                    </div>
                                    <button class="btn btn-primary" style="margin-top: 16px;">Оплатить заказ</button>
                                </div>
                                
                                <div class="order-card">
                                    <div class="order-header">
                                        <span class="order-number-display">Заказ № 123456788</span>
                                        <span class="order-status paid">Оплачен</span>
                                    </div>
                                    <div class="order-details">
                                        <div class="order-detail-item">
                                            <h4>Дата заказа</h4>
                                            <p>15 ноября 2025</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Оригинальная цена</h4>
                                            <p style="text-decoration: line-through; color: var(--dusty-olive);">400 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Итоговая цена</h4>
                                            <p>384 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Всего коробок</h4>
                                            <p>8 коробок (400 шт)</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Получение</h4>
                                            <p>Доставка • 17 ноября</p>
                                        </div>
                                    </div>
                                    <button class="btn btn-outline" style="margin-top: 16px;">Посмотреть детали</button>
                                </div>
                                
                                <div class="order-card">
                                    <div class="order-header">
                                        <span class="order-number-display">Заказ № 123456787</span>
                                        <span class="order-status completed">Выдан</span>
                                    </div>
                                    <div class="order-details">
                                        <div class="order-detail-item">
                                            <h4>Дата заказа</h4>
                                            <p>10 ноября 2025</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Оригинальная цена</h4>
                                            <p style="text-decoration: line-through; color: var(--dusty-olive);">512 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Итоговая цена</h4>
                                            <p>492 000 ₸</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Всего коробок</h4>
                                            <p>10 коробок (500 шт)</p>
                                        </div>
                                        <div class="order-detail-item">
                                            <h4>Получение</h4>
                                            <p>Самовывоз • 12 ноября</p>
                                        </div>
                                    </div>
                                    <button class="btn btn-outline" style="margin-top: 16px;">Повторить заказ</button>
                                </div>
                            </div>
                        </div>

                        <!-- Balance Section -->
                        <div class="account-content-section" id="balanceSection">
                            <h2 style="font-size: 36px; margin-bottom: 40px;">Мой баланс</h2>
                            <div class="info-card" style="padding: 60px; text-align: center; background: linear-gradient(135deg, var(--light-concrete) 0%, var(--white) 100%);">
                                <h3 style="font-size: 18px; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 1px;">Текущий баланс</h3>
                                <p style="font-size: 64px; font-weight: 700; color: var(--accent-orange); letter-spacing: -2px;">2 000 000 ₸</p>
                                <p style="margin-top: 16px; color: var(--dusty-olive);">Средства доступны для оплаты заказов</p>
                            </div>
                            <div style="display: flex; gap: 20px; margin-top: 40px;">
                                <button class="btn btn-primary" style="flex: 1;">Пополнить баланс</button>
                                <button class="btn btn-secondary" style="flex: 1;">История операций</button>
                            </div>
                        </div>

                        <!-- Новая секция доверенных получателей -->
                        <div class="account-content-section" id="recipientsSection">
                            <h2 style="font-size: 36px; margin-bottom: 40px;">Доверенные получатели</h2>
                            <p style="color: var(--dusty-olive); margin-bottom: 32px;">Добавьте контакты сотрудников или курьеров, которым разрешаете получать заказы от вашего имени</p>
                            
                            <div class="recipient-list">
                                <div class="recipient-item">
                                    <div>
                                        <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Айгерим Нурланова</h4>
                                        <p style="font-size: 14px; color: var(--dusty-olive);">+7 (701) 234-56-78 • Курьер</p>
                                    </div>
                                    <button class="btn btn-outline" style="padding: 8px 16px; font-size: 13px;">Удалить</button>
                                </div>
                                
                                <div class="recipient-item">
                                    <div>
                                        <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Марат Жумабеков</h4>
                                        <p style="font-size: 14px; color: var(--dusty-olive);">+7 (702) 345-67-89 • Флорист</p>
                                    </div>
                                    <button class="btn btn-outline" style="padding: 8px 16px; font-size: 13px;">Удалить</button>
                                </div>
                                
                                <div class="recipient-item">
                                    <div>
                                        <h4 style="font-size: 16px; font-weight: 600; margin-bottom: 4px;">Дина Касымова</h4>
                                        <p style="font-size: 14px; color: var(--dusty-olive);">+7 (705) 456-78-90 • Администратор</p>
                                    </div>
                                    <button class="btn btn-outline" style="padding: 8px 16px; font-size: 13px;">Удалить</button>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary" style="margin-top: 32px;">+ Добавить получателя</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3>О компании Florex</h3>
                    <p>Международный оптовый поставщик свежих цветов от ведущих мировых производителей. Профессиональное качество и надёжность для вашего бизнеса.</p>
                </div>
                <div class="footer-section">
                    <h3>Каталог</h3>
                    <div class="footer-links">
                        <a href="#">Розы</a>
                        <a href="#">Тюльпаны</a>
                        <a href="#">Хризантемы</a>
                        <a href="#">Эустома</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Компания</h3>
                    <div class="footer-links">
                        <a href="#">О нас</a>
                        <a href="#">Контакты</a>
                        <a href="#">Доставка</a>
                        <a href="#">Публичная оферта</a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Контакты</h3>
                    <div class="footer-links">
                        <a href="tel:+77008004000">+7 700 800-40-00</a>
                        <a href="mailto:info@florex.kz">info@florex.kz</a>
                        <a href="#">Алматы, Проспект Суюнбая, 37</a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                © 2025 Florex. Все права защищены.
            </div>
        </div>
    </footer>

    <!-- Добавлен чат-бот -->
    <button class="chatbot-trigger" onclick="toggleChatbot()">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
        </svg>
    </button>

    <div class="chatbot-window" id="chatbotWindow">
        <div class="chatbot-header">
            <h3>Консультант Florex</h3>
            <button class="chatbot-close" onclick="toggleChatbot()">×</button>
        </div>
        <div class="chatbot-messages" id="chatMessages">
            <div class="chat-message bot">
                <div class="message-bubble">
                    Здравствуйте! Я виртуальный консультант Florex. Чем могу помочь?
                </div>
            </div>
        </div>
        <div class="chatbot-input-area">
            <input type="text" class="chatbot-input" id="chatInput" placeholder="Напишите ваш вопрос..." onkeypress="if(event.key==='Enter') sendMessage()">
            <button class="chatbot-send" onclick="sendMessage()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"/>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                </svg>
            </button>
        </div>
    </div>

    <script>
        // Sample Products Data with more details
        const products = [
            { id: 1, name: 'Роза Red Naomi', icon: 'rose', color: 'Красный', height: '60', country: 'NL', box: '50', price: 128000, pricePerStem: 2560, category: 'roses', status: 'stock', daysInStock: 3 },
            { id: 2, name: 'Тюльпан Frilled Painted', icon: 'tulip', color: 'Персиковый', height: '38', country: 'NL', box: '50', price: 85000, pricePerStem: 1700, category: 'tulips', status: 'stock', daysInStock: 1 },
            { id: 3, name: 'Роза Avalanche+', icon: 'rose', color: 'Белый', height: '70', country: 'EC', box: '50', price: 145000, pricePerStem: 2900, category: 'roses', status: 'preorder', daysInStock: 0 },
            { id: 4, name: 'Эустома Green Poetry', icon: 'eustoma', color: 'Зеленый', height: '55', country: 'CO', box: '40', price: 92000, pricePerStem: 2300, category: 'eustoma', status: 'stock', daysInStock: 2 },
            { id: 5, name: 'Роза Pink Floyd', icon: 'rose', color: 'Розовый', height: '60', country: 'KE', box: '50', price: 118000, pricePerStem: 2360, category: 'roses', status: 'stock', daysInStock: 4 },
            { id: 6, name: 'Хризантема Baltica', icon: 'chrysanthemum', color: 'Белый', height: '70', country: 'NL', box: '60', price: 78000, pricePerStem: 1300, category: 'chrysanthemums', status: 'stock', daysInStock: 5 },
        ];

        function getFlowerIcon(type) {
            const icons = {
                rose: `<svg class="flower-icon" viewBox="0 0 200 200" fill="currentColor">
                    <path d="M100 180 C80 180 60 170 50 150 C40 130 40 110 50 90 C60 70 80 60 100 60 C120 60 140 70 150 90 C160 110 160 130 150 150 C140 170 120 180 100 180Z"/>
                    <ellipse cx="100" cy="100" rx="30" ry="40" opacity="0.8"/>
                    <ellipse cx="80" cy="95" rx="25" ry="35" opacity="0.6"/>
                    <ellipse cx="120" cy="95" rx="25" ry="35" opacity="0.6"/>
                    <ellipse cx="100" cy="80" rx="20" ry="25" opacity="0.7"/>
                    <circle cx="100" cy="100" r="15" opacity="0.9"/>
                    <line x1="100" y1="180" x2="100" y2="200" stroke="currentColor" stroke-width="3"/>
                </svg>`,
                tulip: `<svg class="flower-icon" viewBox="0 0 200 200" fill="currentColor">
                    <path d="M100 60 C80 60 70 80 70 100 C70 110 75 120 85 125 L85 190 C85 195 92 198 100 198 C108 198 115 195 115 190 L115 125 C125 120 130 110 130 100 C130 80 120 60 100 60Z"/>
                    <ellipse cx="80" cy="90" rx="20" ry="40" transform="rotate(-20 80 90)" opacity="0.8"/>
                    <ellipse cx="120" cy="90" rx="20" ry="40" transform="rotate(20 120 90)" opacity="0.8"/>
                    <ellipse cx="100" cy="75" rx="18" ry="35" opacity="0.9"/>
                </svg>`,
                eustoma: `<svg class="flower-icon" viewBox="0 0 200 200" fill="currentColor">
                    <circle cx="100" cy="100" r="35" opacity="0.3"/>
                    <path d="M100 70 Q120 80 125 100 Q120 120 100 130 Q80 120 75 100 Q80 80 100 70Z" opacity="0.6"/>
                    <path d="M70 100 Q80 80 100 75 Q120 80 130 100 Q120 120 100 125 Q80 120 70 100Z" opacity="0.5"/>
                    <circle cx="100" cy="100" r="12" opacity="0.9"/>
                    <line x1="100" y1="130" x2="100" y2="190" stroke="currentColor" stroke-width="2"/>
                    <path d="M85 150 Q80 155 85 160" fill="none" stroke="currentColor" stroke-width="2"/>
                    <path d="M115 150 Q120 155 115 160" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>`,
                chrysanthemum: `<svg class="flower-icon" viewBox="0 0 200 200" fill="currentColor">
                    <circle cx="100" cy="100" r="15" opacity="0.9"/>
                    ${Array.from({length: 16}, (_, i) => {
                        const angle = (i * 22.5) * Math.PI / 180;
                        const x = 100 + Math.cos(angle) * 40;
                        const y = 100 + Math.sin(angle) * 40;
                        return `<ellipse cx="${x}" cy="${y}" rx="8" ry="25" transform="rotate(${i * 22.5} ${x} ${y})" opacity="0.6"/>`;
                    }).join('')}
                    <line x1="100" y1="140" x2="100" y2="195" stroke="currentColor" stroke-width="2"/>
                </svg>`
            };
            return icons[type] || icons.rose;
        }

        let cart = [];
        let currentProduct = null;
        let discount = 0; // Initialize discount to 0

        // Screen Navigation
        function showScreen(screenName) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenName + 'Screen').classList.add('active');
            
            if (screenName === 'catalog') {
                renderProducts();
            } else if (screenName === 'cart') {
                renderCart();
            } else if (screenName === 'checkout') {
                renderCheckout();
            }
            
            window.scrollTo(0, 0);
        }

        function startRegistration(e) {
            e.preventDefault();
            const phone = document.getElementById('phoneNumber').value;
            document.getElementById('displayPhone').textContent = phone;
            showScreen('sms');
            
            // Auto-focus first input
            setTimeout(() => {
                document.getElementById('code1').focus();
            }, 100);
        }

        function verifySMS(e) {
            e.preventDefault();
            // Verify SMS code (in real app would check with server)
            showScreen('catalog');
            renderProducts();
        }

        function resendCode() {
            alert('Код отправлен повторно!');
        }

        function applyFilters() {
            renderProducts();
            updateActiveFilters(); // Also update active filters display
        }

        function renderProducts(filter = 'all') {
            const grid = document.getElementById('productsGrid');
            let filtered = [...products]; // Create a copy to avoid modifying original array
            
            // Apply filters
            const filterType = document.getElementById('filterType')?.value;
            const filterCountry = document.getElementById('filterCountry')?.value;
            const filterAvailability = document.getElementById('filterAvailability')?.value;
            const filterColor = document.getElementById('filterColor')?.value;
            const filterHeight = document.getElementById('filterHeight')?.value;
            const filterDays = document.getElementById('filterDays')?.value;
            const sortSelect = document.querySelector('.sort-btn.active')?.getAttribute('data-sort-key') || 'popular'; // Get sort key from active button
            
            if (filterType) filtered = filtered.filter(p => p.category === filterType);
            if (filterCountry) filtered = filtered.filter(p => p.country === filterCountry);
            if (filterAvailability) filtered = filtered.filter(p => p.status === filterAvailability);
            if (filterColor) filtered = filtered.filter(p => p.color === filterColor);
            if (filterHeight) filtered = filtered.filter(p => p.height === filterHeight);
            if (filterDays) filtered = filtered.filter(p => p.daysInStock <= parseInt(filterDays));
            
            // Apply sorting
            if (sortSelect === 'price-asc') {
                filtered.sort((a, b) => a.price - b.price);
            } else if (sortSelect === 'price-desc') {
                filtered.sort((a, b) => b.price - a.price);
            } else if (sortSelect === 'name') {
                filtered.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sortSelect === 'stock') {
                filtered.sort((a, b) => {
                    if (a.status === 'stock' && b.status !== 'stock') return -1;
                    if (a.status !== 'stock' && b.status === 'stock') return 1;
                    return b.daysInStock - a.daysInStock;
                });
            } else if (sortSelect === 'popular') {
                // Default sort or sort by a 'popularity' field if available
                filtered.sort((a, b) => a.id - b.id); // Simple sort by ID as placeholder
            }
            
            grid.innerHTML = filtered.map(product => `
                <div class="product-card" onclick="showProduct(${product.id})">
                    <div class="product-image">
                        ${getFlowerIcon(product.icon)}
                        <div class="product-status ${product.status === 'stock' ? 'in-stock' : 'pre-order'}">
                            ${product.status === 'stock' ? `В наличии ${product.daysInStock}д` : 'В пути'}
                        </div>
                    </div>
                    <div class="product-info">
                        <h3 class="product-name">${product.name}</h3>
                        <div class="product-meta">
                            <span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                ${product.color}
                            </span>
                            <span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="2" x2="12" y2="22"/>
                                    <line x1="17" y1="7" x2="7" y2="17"/>
                                </svg>
                                ${product.height} см
                            </span>
                            <span>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                </svg>
                                ${product.country}
                            </span>
                        </div>
                        <div class="product-price">
                            <div class="product-pricing">
                                <div class="price-per-box">${product.price.toLocaleString('ru-RU')} ₸</div>
                                <div class="price-per-unit">За упаковку (${product.box} шт) • ${product.pricePerStem.toLocaleString('ru-RU')} ₸/шт</div>
                            </div>
                            <button class="add-to-cart-btn" onclick="event.stopPropagation(); quickAddToCart(${product.id})">В корзину</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function setSorting(sort, btn) {
            document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            applyFilters(); // Re-apply filters to sort
        }

        function resetFilters() {
            document.getElementById('filterType').value = '';
            document.getElementById('filterCountry').value = '';
            document.getElementById('filterAvailability').value = '';
            document.getElementById('filterColor').value = '';
            document.getElementById('filterHeight').value = '';
            document.getElementById('filterDays').value = '';
            document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
            document.querySelector('.sort-btn[data-sort-key="popular"]').classList.add('active'); // Set default active sort button
            applyFilters();
        }

        function updateActiveFilters() {
            const activeFiltersDiv = document.getElementById('activeFilters');
            const filters = [];
            
            const filterType = document.getElementById('filterType')?.value;
            const filterCountry = document.getElementById('filterCountry')?.value;
            const filterAvailability = document.getElementById('filterAvailability')?.value;
            const filterColor = document.getElementById('filterColor')?.value;
            const filterHeight = document.getElementById('filterHeight')?.value;
            const filterDays = document.getElementById('filterDays')?.value;
            
            if (filterType) {
                const text = document.getElementById('filterType').selectedOptions[0].text;
                filters.push({ key: 'filterType', label: text });
            }
            if (filterCountry) {
                const text = document.getElementById('filterCountry').selectedOptions[0].text;
                filters.push({ key: 'filterCountry', label: text });
            }
            if (filterAvailability) {
                const text = document.getElementById('filterAvailability').selectedOptions[0].text;
                filters.push({ key: 'filterAvailability', label: text });
            }
            if (filterColor) {
                filters.push({ key: 'filterColor', label: filterColor });
            }
            if (filterHeight) {
                filters.push({ key: 'filterHeight', label: `${filterHeight} см` });
            }
            if (filterDays) {
                const text = document.getElementById('filterDays').selectedOptions[0].text;
                filters.push({ key: 'filterDays', label: text });
            }
            
            if (filters.length > 0) {
                activeFiltersDiv.innerHTML = `
                    <span class="active-filters-label">Активные фильтры:</span>
                    ${filters.map(f => `
                        <span class="filter-chip">
                            ${f.label}
                            <svg onclick="removeFilter('${f.key}')" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="18" y1="6" x2="6" y2="18"/>
                                <line x1="6" y1="6" x2="18" y2="18"/>
                            </svg>
                        </span>
                    `).join('')}
                `;
            } else {
                activeFiltersDiv.innerHTML = '';
            }
        }

        function removeFilter(key) {
            document.getElementById(key).value = '';
            applyFilters();
        }

        // Show Product Detail
        function showProduct(id) {
            currentProduct = products.find(p => p.id === id);
            document.getElementById('productDetailImage').innerHTML = getFlowerIcon(currentProduct.icon); // Use innerHTML for SVG
            document.getElementById('productDetailName').textContent = currentProduct.name;
            document.getElementById('productDetailArticle').textContent = `Артикул: ${currentProduct.id}${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
            document.getElementById('productDetailColor').textContent = currentProduct.color;
            document.getElementById('productDetailHeight').textContent = currentProduct.height;
            document.getElementById('productDetailCountry').textContent = currentProduct.country === 'NL' ? 'Нидерланды' : currentProduct.country === 'EC' ? 'Эквадор' : currentProduct.country === 'KE' ? 'Кения' : currentProduct.country === 'CO' ? 'Колумбия' : currentProduct.country;
            document.getElementById('productDetailBox').textContent = `${currentProduct.box} шт`;
            document.getElementById('productDetailPrice').textContent = currentProduct.price.toLocaleString('ru-RU');
            document.getElementById('productQuantity').value = 1;
            showScreen('product');
        }

        // Quantity Controls
        function changeQuantity(delta) {
            const input = document.getElementById('productQuantity');
            const newValue = parseInt(input.value) + delta;
            if (newValue >= 1) {
                input.value = newValue;
            }
        }

        // Add to Cart
        function quickAddToCart(id) {
            const product = products.find(p => p.id === id);
            addToCart(product, 1);
        }

        function addToCartFromDetail() {
            const quantity = parseInt(document.getElementById('productQuantity').value);
            addToCart(currentProduct, quantity);
            showScreen('cart');
        }

        function addToCart(product, quantity) {
            const existing = cart.find(item => item.id === product.id);
            if (existing) {
                existing.quantity += quantity;
            } else {
                cart.push({ ...product, quantity });
            }
            updateCartCount();
            renderCart(); // Re-render cart to reflect changes
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Render Cart
        function renderCart() {
            const cartItems = document.getElementById('cartItems');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<div style="text-align: center; padding: 80px 0; color: var(--dusty-olive)"><h2 style="font-size: 32px; margin-bottom: 16px;">Корзина пуста</h2><p style="margin: 20px 0; font-size: 16px;">Добавьте товары из каталога</p><button class="btn btn-primary" onclick="showScreen(\'catalog\')">Перейти в каталог</button></div>';
                document.getElementById('summaryItemCount').textContent = '0';
                document.getElementById('summarySubtotal').textContent = '0 ₸';
                document.getElementById('summaryDiscount').textContent = '0 ₸';
                document.getElementById('summaryTotal').textContent = '0 ₸';
                // Reset calculator if cart is empty
                if (document.getElementById('totalPackages')) {
                    document.getElementById('totalPackages').textContent = '0';
                    document.getElementById('totalBoxes').textContent = '0';
                    document.getElementById('totalStems').textContent = '0';
                }
                return;
            }
            
            cartItems.innerHTML = cart.map((item, index) => `
                <div class="cart-item">
                    <div class="cart-item-image">${getFlowerIcon(item.icon)}</div>
                    <div class="cart-item-info">
                        <h3>${item.name}</h3>
                        <div class="cart-item-meta">
                            <span>${item.color} • ${item.height} см • ${item.box} шт</span>
                        </div>
                        <div class="cart-item-quantity">
                            <div class="quantity-controls">
                                <button class="quantity-btn" onclick="updateCartQuantity(${index}, -1)">−</button>
                                <input type="number" class="quantity-input" value="${item.quantity}" readonly>
                                <button class="quantity-btn" onclick="updateCartQuantity(${index}, 1)">+</button>
                            </div>
                        </div>
                    </div>
                    <div class="cart-item-actions">
                        <div class="cart-item-price">${(item.price * item.quantity).toLocaleString('ru-RU')} ₸</div>
                        <button class="remove-btn" onclick="removeFromCart(${index})">Удалить</button>
                    </div>
                </div>
            `).join('');
            
            updateCartSummary();
        }

        function updateCartQuantity(index, delta) {
            cart[index].quantity += delta;
            if (cart[index].quantity < 1) {
                cart.splice(index, 1);
            }
            updateCartCount();
            renderCart();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartCount();
            renderCart();
        }

        function updateCartSummary() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const totalStems = cart.reduce((sum, item) => sum + (item.quantity * parseInt(item.box)), 0);
            const totalBoxes = itemCount; // In this case, each package = 1 box
            
            document.getElementById('summaryItemCount').textContent = itemCount;
            document.getElementById('summarySubtotal').textContent = subtotal.toLocaleString('ru-RU') + ' ₸';
            document.getElementById('summaryDiscount').textContent = discount.toLocaleString('ru-RU') + ' ₸';
            document.getElementById('summaryTotal').textContent = (subtotal - discount).toLocaleString('ru-RU') + ' ₸';
            
            // Update calculator
            if (document.getElementById('totalPackages')) {
                document.getElementById('totalPackages').textContent = itemCount;
                document.getElementById('totalBoxes').textContent = totalBoxes;
                document.getElementById('totalStems').textContent = totalStems;
            }
        }

        function applyPromo() {
            const promoInput = document.getElementById('promoInput');
            const promoCode = promoInput.value.trim().toUpperCase();
            
            if (promoCode === 'FLOREX15') {
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                discount = Math.floor(subtotal * 0.15);
                alert('Промокод применен! Скидка 15%');
                updateCartSummary();
            } else if (promoCode) {
                alert('Неверный промокод');
                discount = 0; // Reset discount if invalid code
                updateCartSummary();
            }
        }

        // Render Checkout
        function renderCheckout() {
            const checkoutItems = document.getElementById('checkoutItems');
            checkoutItems.innerHTML = cart.map(item => `
                <div class="order-item">
                    <div class="order-item-image">${getFlowerIcon(item.icon)}</div>
                    <div class="order-item-info">
                        <h4>${item.name}</h4>
                        <p>${item.quantity} × ${item.price.toLocaleString('ru-RU')} ₸</p>
                    </div>
                    <div class="order-item-price">${(item.price * item.quantity).toLocaleString('ru-RU')} ₸</div>
                </div>
            `).join('');
            
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('checkoutSubtotal').textContent = subtotal.toLocaleString('ru-RU') + ' ₸';
            document.getElementById('checkoutDelivery').textContent = '0 ₸'; // Default, will be updated
            document.getElementById('checkoutTotal').textContent = subtotal.toLocaleString('ru-RU') + ' ₸'; // Default, will be updated
        }

        // Delivery Selection
        function selectDelivery(element) {
            document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            
            const deliveryCost = element.querySelector('strong').textContent === 'Бесплатно' ? 0 : parseInt(element.querySelector('strong').textContent.replace(' ₸', ''));
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            document.getElementById('checkoutDelivery').textContent = deliveryCost.toLocaleString('ru-RU') + ' ₸';
            document.getElementById('checkoutTotal').textContent = (subtotal + deliveryCost - discount).toLocaleString('ru-RU') + ' ₸'; // Apply discount
        }

        // Payment Selection
        let selectedPaymentType = 'card';
        function selectPayment(element, type) {
            document.querySelectorAll('.payment-method').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            selectedPaymentType = type;
        }

        // Proceed to Payment
        function proceedToPayment() {
            const orderNumber = Math.floor(100000000 + Math.random() * 900000000);
            const total = document.getElementById('checkoutTotal').textContent;
            
            document.getElementById('paymentOrderNumber').textContent = orderNumber;
            document.getElementById('paymentAmount').textContent = total;
            
            const paymentMethods = {
                'card': 'Оплата банковской картой',
                'kaspi': 'Kaspi Pay',
                'balance': 'Оплата с баланса',
                'invoice': 'Выставлен счет на оплату'
            };
            
            document.getElementById('selectedPaymentMethod').textContent = paymentMethods[selectedPaymentType];
            
            if (selectedPaymentType === 'card') {
                document.getElementById('cardPaymentForm').style.display = 'block';
            } else {
                document.getElementById('cardPaymentForm').style.display = 'none';
            }
            
            showScreen('payment');
        }

        // Complete Payment
        function completePayment() {
            const orderNumber = document.getElementById('paymentOrderNumber').textContent;
            document.getElementById('successOrderNumber').textContent = orderNumber;
            cart = []; // Clear cart after successful payment
            discount = 0; // Reset discount
            updateCartCount();
            showScreen('success');
        }

        // Account Sections
        function showAccountSection(section) {
            document.querySelectorAll('.account-menu-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.account-content-section').forEach(sec => sec.classList.remove('active'));
            
            // Use event.currentTarget to get the element that triggered the event
            event.currentTarget.classList.add('active'); 
            document.getElementById(section + 'Section').classList.add('active');
        }

        function toggleChatbot() {
            const chatbot = document.getElementById('chatbotWindow');
            chatbot.classList.toggle('active');
            
            if (chatbot.classList.contains('active')) {
                document.getElementById('chatInput').focus();
            }
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML += `
                <div class="chat-message user">
                    <div class="message-bubble">${message}</div>
                </div>
            `;
            
            input.value = '';
            
            // Simulate bot response
            setTimeout(() => {
                const responses = [
                    'Спасибо за ваш вопрос! Наш специалист свяжется с вами в ближайшее время.',
                    'Я передал ваш запрос менеджеру. Ожидайте звонка в течение 15 минут.',
                    'Для уточнения деталей вашего заказа, пожалуйста, позвоните нам по телефону +7 700 800-40-00'
                ];
                
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                messagesContainer.innerHTML += `
                    <div class="chat-message bot">
                        <div class="message-bubble">${randomResponse}</div>
                    </div>
                `;
                
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, 1000);
            
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize SMS inputs auto-navigation
            const smsInputs = ['code1', 'code2', 'code3', 'code4'];
            smsInputs.forEach((id, index) => {
                const input = document.getElementById(id);
                if (input) {
                    input.addEventListener('input', (e) => {
                        if (e.target.value.length === 1 && index < smsInputs.length - 1) {
                            document.getElementById(smsInputs[index + 1]).focus();
                        }
                    });
                    
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
                            document.getElementById(smsInputs[index - 1]).focus();
                        }
                    });
                }
            });
        });
    </script>
</body>
</html>
